<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>拼音发音测试</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        .test-button:hover {
            background: #0056b3;
        }
        .result {
            margin-top: 10px;
            padding: 10px;
            background: #f8f9fa;
            border-left: 4px solid #007bff;
        }
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        .comparison-table th, .comparison-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }
        .comparison-table th {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>
    <h1>拼音发音测试</h1>
    
    <div class="test-section">
        <h2>1. 带声调拼音字母测试</h2>
        <p>测试Web Speech API是否能正确发出带声调的拼音字母：</p>
        <div>
            <button class="test-button" onclick="testAccentedPinyin('á')">á (第一声)</button>
            <button class="test-button" onclick="testAccentedPinyin('é')">é (第二声)</button>
            <button class="test-button" onclick="testAccentedPinyin('í')">í (第三声)</button>
            <button class="test-button" onclick="testAccentedPinyin('ó')">ó (第四声)</button>
            <button class="test-button" onclick="testAccentedPinyin('ú')">ú (第一声)</button>
        </div>
        <div>
            <button class="test-button" onclick="testAccentedPinyin('ǎ')">ǎ (第三声)</button>
            <button class="test-button" onclick="testAccentedPinyin('è')">è (第四声)</button>
            <button class="test-button" onclick="testAccentedPinyin('ì')">ì (第四声)</button>
            <button class="test-button" onclick="testAccentedPinyin('ò')">ò (第四声)</button>
            <button class="test-button" onclick="testAccentedPinyin('ù')">ù (第四声)</button>
        </div>
        <div id="accented-result" class="result" style="display:none;"></div>
    </div>

    <div class="test-section">
        <h2>2. 辅音字母测试</h2>
        <p>测试辅音字母的发音效果：</p>
        <div>
            <button class="test-button" onclick="testConsonant('l')">l</button>
            <button class="test-button" onclick="testConsonant('m')">m</button>
            <button class="test-button" onclick="testConsonant('n')">n</button>
            <button class="test-button" onclick="testConsonant('s')">s</button>
            <button class="test-button" onclick="testConsonant('sh')">sh</button>
            <button class="test-button" onclick="testConsonant('zh')">zh</button>
        </div>
        <div id="consonant-result" class="result" style="display:none;"></div>
    </div>

    <div class="test-section">
        <h2>3. 发音效果对比</h2>
        <p>对比直接拼音发音与汉字映射发音：</p>
        <table class="comparison-table">
            <thead>
                <tr>
                    <th>拼音</th>
                    <th>直接发音</th>
                    <th>汉字映射</th>
                    <th>效果评价</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>á</td>
                    <td><button class="test-button" onclick="speakDirect('á')">发音á</button></td>
                    <td><button class="test-button" onclick="speakChinese('阿')">发音阿</button></td>
                    <td id="eval-a">-</td>
                </tr>
                <tr>
                    <td>é</td>
                    <td><button class="test-button" onclick="speakDirect('é')">发音é</button></td>
                    <td><button class="test-button" onclick="speakChinese('额')">发音额</button></td>
                    <td id="eval-e">-</td>
                </tr>
                <tr>
                    <td>í</td>
                    <td><button class="test-button" onclick="speakDirect('í')">发音í</button></td>
                    <td><button class="test-button" onclick="speakChinese('衣')">发音衣</button></td>
                    <td id="eval-i">-</td>
                </tr>
                <tr>
                    <td>ó</td>
                    <td><button class="test-button" onclick="speakDirect('ó')">发音ó</button></td>
                    <td><button class="test-button" onclick="speakChinese('哦')">发音哦</button></td>
                    <td id="eval-o">-</td>
                </tr>
                <tr>
                    <td>ú</td>
                    <td><button class="test-button" onclick="speakDirect('ú')">发音ú</button></td>
                    <td><button class="test-button" onclick="speakChinese('乌')">发音乌</button></td>
                    <td id="eval-u">-</td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="test-section">
        <h2>4. 完整拼音测试</h2>
        <p>测试完整拼音的分解发音：</p>
        <div>
            <button class="test-button" onclick="testFullPinyin('liù', ['l', 'i', 'ù'])">六 (liù)</button>
            <button class="test-button" onclick="testFullPinyin('shuǐ', ['sh', 'u', 'ǐ'])">水 (shuǐ)</button>
            <button class="test-button" onclick="testFullPinyin('má', ['m', 'á'])">妈 (má)</button>
        </div>
        <div id="full-pinyin-result" class="result" style="display:none;"></div>
    </div>

    <script>
        // 语音合成实例
        const synth = window.speechSynthesis;
        
        // 测试带声调拼音字母
        function testAccentedPinyin(pinyin) {
            const resultDiv = document.getElementById('accented-result');
            resultDiv.style.display = 'block';
            
            // 尝试不同的语音引擎
            const voices = synth.getVoices();
            const chineseVoices = voices.filter(voice => 
                voice.lang.includes('zh') || voice.lang.includes('cmn')
            );
            const englishVoices = voices.filter(voice => 
                voice.lang.includes('en')
            );
            
            resultDiv.innerHTML = `<h4>测试 "${pinyin}":</h4>`;
            
            // 使用中文语音引擎
            if (chineseVoices.length > 0) {
                const utterance = new SpeechSynthesisUtterance(pinyin);
                utterance.voice = chineseVoices[0];
                utterance.rate = 0.8;
                utterance.pitch = 1;
                synth.speak(utterance);
                resultDiv.innerHTML += `<p>✓ 使用中文语音引擎: ${chineseVoices[0].name}</p>`;
            }
            
            // 延迟后使用英文语音引擎测试
            setTimeout(() => {
                if (englishVoices.length > 0) {
                    const utterance = new SpeechSynthesisUtterance(pinyin);
                    utterance.voice = englishVoices[0];
                    utterance.rate = 0.8;
                    utterance.pitch = 1;
                    synth.speak(utterance);
                    resultDiv.innerHTML += `<p>✓ 使用英文语音引擎: ${englishVoices[0].name}</p>`;
                }
            }, 1000);
        }
        
        // 测试辅音字母
        function testConsonant(consonant) {
            const resultDiv = document.getElementById('consonant-result');
            resultDiv.style.display = 'block';
            
            const utterance = new SpeechSynthesisUtterance(consonant);
            utterance.rate = 0.8;
            utterance.pitch = 1;
            synth.speak(utterance);
            
            resultDiv.innerHTML = `<p>发音辅音: "${consonant}"</p>`;
        }
        
        // 直接发音
        function speakDirect(text) {
            const utterance = new SpeechSynthesisUtterance(text);
            const voices = synth.getVoices();
            const chineseVoices = voices.filter(voice => 
                voice.lang.includes('zh') || voice.lang.includes('cmn')
            );
            
            if (chineseVoices.length > 0) {
                utterance.voice = chineseVoices[0];
            }
            utterance.rate = 0.8;
            synth.speak(utterance);
        }
        
        // 汉字发音
        function speakChinese(text) {
            const utterance = new SpeechSynthesisUtterance(text);
            const voices = synth.getVoices();
            const chineseVoices = voices.filter(voice => 
                voice.lang.includes('zh') || voice.lang.includes('cmn')
            );
            
            if (chineseVoices.length > 0) {
                utterance.voice = chineseVoices[0];
            }
            utterance.rate = 0.8;
            synth.speak(utterance);
        }
        
        // 测试完整拼音分解
        function testFullPinyin(fullPinyin, components) {
            const resultDiv = document.getElementById('full-pinyin-result');
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = `<h4>测试 "${fullPinyin}" 的分解发音:</h4>`;
            
            let delay = 0;
            components.forEach((component, index) => {
                setTimeout(() => {
                    const utterance = new SpeechSynthesisUtterance(component);
                    const voices = synth.getVoices();
                    const chineseVoices = voices.filter(voice => 
                        voice.lang.includes('zh') || voice.lang.includes('cmn')
                    );
                    
                    if (chineseVoices.length > 0) {
                        utterance.voice = chineseVoices[0];
                    }
                    utterance.rate = 0.8;
                    synth.speak(utterance);
                    
                    resultDiv.innerHTML += `<p>${index + 1}. 发音: "${component}"</p>`;
                }, delay);
                delay += 800;
            });
            
            // 最后发完整拼音
            setTimeout(() => {
                const utterance = new SpeechSynthesisUtterance(fullPinyin);
                const voices = synth.getVoices();
                const chineseVoices = voices.filter(voice => 
                    voice.lang.includes('zh') || voice.lang.includes('cmn')
                );
                
                if (chineseVoices.length > 0) {
                    utterance.voice = chineseVoices[0];
                }
                utterance.rate = 0.8;
                synth.speak(utterance);
                
                resultDiv.innerHTML += `<p><strong>完整发音: "${fullPinyin}"</strong></p>`;
            }, delay);
        }
        
        // 等待语音引擎加载
        window.addEventListener('load', () => {
            if (synth.getVoices().length === 0) {
                synth.addEventListener('voiceschanged', () => {
                    console.log('语音引擎已加载');
                });
            }
        });
    </script>
</body>
</html>